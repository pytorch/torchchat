
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
PyTorch version 2.6.0.dev20241002+cu121 available.
lm_eval is not installed, GPTQ may not be usable
Using device=cuda NVIDIA PG509-210
Loading model...
Time to load model: 4.89 seconds
Quantizing the model with: {'linear:int8': {'groupsize': 0}, 'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cuda'}}
Time to quantize model: 0.39 seconds
-----------------------------------------------------------
Once upon a time, in a small village nestled in the rolling hills of Tuscany, there was a young girl named Sophia. Sophia was a curious and adventurous child, always eager to explore the world around her. One day, while wandering through the village, she stumbled upon a small, mysterious shop tucked away on a narrow street. The sign above the door read "Magical Curios and Wonders."
Sophia's curiosity was piqued, and she pushed open the creaky door to enter the shop. Inside, she found a treasure trove of strange and wondrous objects, each one more fascinating than the last. There were glowing crystals, shimmering fabrics, and mysterious artifacts that seemed to hold secrets and stories of their own.
At the back of the shop, Sophia spotted an old woman with a kind face and twinkling eyes. The woman introduced herself as Signora Rosa, the proprietor of the shop, and welcomed Sophia with a warm smile.
"Welcome, dear one," Signora
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 1: 26.8527 sec total                 
Time to first token: 1.4121 sec with parallel prefill.                

      Total throughput: 7.4480 tokens/sec, 0.1343 s/token                 
First token throughput: 0.7082 tokens/sec, 1.4121 s/token                 
 Next token throughput: 7.8221 tokens/sec, 0.1278 s/token                     

Bandwidth achieved: 63.75 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, in a small town nestled in the rolling hills of the countryside, there was a beautiful and mysterious forest. The forest was home to a variety of creatures, from the tiniest insects to the largest and most majestic animals. It was a place of wonder and magic, where the trees seemed to whisper secrets to each other and the flowers bloomed in every color of the rainbow.
But the forest was also a place of danger, where the creatures that lived there could be fierce and unforgiving. There were rumors of a great beast that roamed the forest, a creature so powerful and terrifying that even the bravest of hunters dared not venture near.
One day, a young girl named Lily wandered into the forest, searching for a rare and precious flower that only bloomed in the depths of the woods. She had heard that the flower had the power to grant wishes, and she had always dreamed of finding it. As she walked deeper into the forest, the trees seemed to close in around
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 2: 24.9996 sec total                 
Time to first token: 0.1104 sec with parallel prefill.                

      Total throughput: 8.0001 tokens/sec, 0.1250 s/token                 
First token throughput: 9.0614 tokens/sec, 0.1104 s/token                 
 Next token throughput: 7.9954 tokens/sec, 0.1251 s/token                     

Bandwidth achieved: 68.47 GB/s

========================================

Once upon a time, in a land far, far away, there was a mythical creature known as the “River Queen”. She was said to be a stunningly beautiful woman with long, flowing hair the color of the river itself, and skin that shone like the sun-kissed waters. Her voice was like music, and her presence was as soothing as a gentle breeze on a summer’s day.
According to legend, the River Queen lived in a magnificent palace built on the water, surrounded by lush greenery and sparkling fountains. The palace was said to be made of a shimmering white stone that seemed to glow from within, and its walls were adorned with intricate carvings that told the story of the river’s history and the secrets of the forest.
The River Queen was said to be a wise and just ruler, loved by all who knew her. She was a guardian of the river and its creatures, and she worked tirelessly to keep the waters clean and pure. Her wisdom and kindness were renowned
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 3: 27.5068 sec total                 
Time to first token: 0.1085 sec with parallel prefill.                

      Total throughput: 7.2709 tokens/sec, 0.1375 s/token                 
First token throughput: 9.2159 tokens/sec, 0.1085 s/token                 
 Next token throughput: 7.2632 tokens/sec, 0.1377 s/token                     

Bandwidth achieved: 62.23 GB/s

========================================


      Average tokens/sec (total): 7.57                 
Average tokens/sec (first token): 6.33                 
Average tokens/sec (next tokens): 7.69 
                
Memory used: 28.86 GB
