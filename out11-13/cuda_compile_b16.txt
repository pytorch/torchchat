
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --compile --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --compile --num-samples 3
PyTorch version 2.6.0.dev20241002+cu121 available.
lm_eval is not installed, GPTQ may not be usable
Using device=cuda NVIDIA PG509-210
Loading model...
Time to load model: 4.87 seconds
Quantizing the model with: {'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cuda'}}
Time to quantize model: 0.01 seconds
-----------------------------------------------------------
Once upon a time, in a far-off place called the internet, there was a magical kingdom known as YouTube. In this kingdom, there lived a group of talented storytellers known as YouTubers. They spent their days weaving tales of adventure, romance, and comedy for the kingdom's inhabitants, who were known as viewers.
The most skilled of these storytellers was a YouTuber named Max. He was known for his epic tales of fantasy and science fiction, which he would bring to life with his trusty sidekicks: his cameraman, Mike, and his editor, Emma.
Max's stories were the stuff of legend, with thrilling plot twists and memorable characters that left viewers eagerly anticipating his next video. His kingdom was filled with fans who eagerly awaited his uploads, and his channel was among the most popular in the land.

But there was a problem in the kingdom. A rival kingdom, known as TikTok, had risen to challenge Max's dominance. Their queen, a young and ambitious woman
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 1: 206.6868 sec total                 
Time to first token: 1.3816 sec with parallel prefill.                

      Total throughput: 0.9676 tokens/sec, 1.0334 s/token                 
First token throughput: 0.7238 tokens/sec, 1.3816 s/token                 
 Next token throughput: 0.9693 tokens/sec, 1.0317 s/token                     

Bandwidth achieved: 15.54 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches, JIT compilation. ***
just-in-time compilation time (incl run time): 2.1e+02 seconds

========================================

Once upon a time, in a small village surrounded by vast fields of golden wheat and gentle rolling hills, there lived a young apprentice named Kaito. Kaito was a skilled weaver, known for his exceptional talent in creating the most intricate and beautiful fabrics in the village. He spent his days working tirelessly in the workshop of the village elder, creating beautiful textiles that were sought after by people from all over the land.

One day, while working on a particularly intricate piece, Kaito noticed a small, shimmering thread that had gotten tangled in the loom. As he carefully untangled it, he felt an inexplicable connection to the thread and began to feel a strange sensation, as if the thread was calling to him.

Intrigued, Kaito decided to investigate further and carefully examined the thread. To his surprise, he discovered that it was made of the finest, most luxurious silk he had ever seen. As he continued to study the thread, he began to feel a sense of
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 2: 4.5275 sec total                 
Time to first token: 0.1032 sec with parallel prefill.                

      Total throughput: 44.1741 tokens/sec, 0.0226 s/token                 
First token throughput: 9.6875 tokens/sec, 0.1032 s/token                 
 Next token throughput: 44.9787 tokens/sec, 0.0222 s/token                     

Bandwidth achieved: 709.46 GB/s

========================================

Once upon a time, there was a beautiful young woman named Aisha who lived in a small village surrounded by vast deserts and majestic mountains. Aisha was known throughout the land for her exceptional beauty, intelligence, and kindness. She had long, dark hair and piercing blue eyes that sparkled like the stars on a clear night. Her skin was smooth and unblemished, with a subtle golden glow that hinted at her love for the sun.
Aisha lived a simple life, spending her days helping her mother with household chores, tending to their small garden, and exploring the surrounding wilderness. She was fascinated by the stories of her grandmother, a wise and ancient woman who had spent her life studying the art of healing and the magic of the natural world. Aisha's grandmother had passed down to her the secrets of herbalism, astrology, and spiritual growth, and Aisha was determined to master them all.
One day, as Aisha was wandering through the desert, she stumbled upon a hidden oasis. The
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 3: 2.7053 sec total                 
Time to first token: 0.1025 sec with parallel prefill.                

      Total throughput: 73.9291 tokens/sec, 0.0135 s/token                 
First token throughput: 9.7575 tokens/sec, 0.1025 s/token                 
 Next token throughput: 76.4558 tokens/sec, 0.0131 s/token                     

Bandwidth achieved: 1187.34 GB/s

========================================


      Average tokens/sec (total): 39.69                 
Average tokens/sec (first token): 6.72                 
Average tokens/sec (next tokens): 40.80 
                
Memory used: 16.90 GB
