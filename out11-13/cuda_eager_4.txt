
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"linear:int4": {"groupsize": 256}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"linear:int4": {"groupsize": 256}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
PyTorch version 2.6.0.dev20241002+cu121 available.
lm_eval is not installed, GPTQ may not be usable
Using device=cuda NVIDIA PG509-210
Loading model...
Time to load model: 4.91 seconds
Quantizing the model with: {'linear:int4': {'groupsize': 256}, 'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cuda'}}
Time to quantize model: 0.56 seconds
-----------------------------------------------------------
Once upon a time, a young prince named Kiros lived in a far-off kingdom. He was a kind and gentle soul, loved by all who knew him. One day, a wise old wizard named Orion appeared in the kingdom, and with him came a mysterious curse that would change Kiros's life forever. The wizard prophesied that Kiros would be the one to save the kingdom from an impending doom, but it would come at a great cost.
Determined to save his kingdom, Kiros embarked on a perilous journey to discover the source of the impending doom. Along the way, he encountered many challenges and obstacles, including treacherous landscapes, fearsome creatures, and even his own doubts and fears. Despite these challenges, Kiros persevered and eventually reached the location of the impending doom.
What he found there shocked him. It was not what he had expected, and it would change everything he thought he knew about the kingdom and himself. The impending doom was not a monster or a curse
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 1: 22.5525 sec total                 
Time to first token: 1.2508 sec with parallel prefill.                

      Total throughput: 8.8682 tokens/sec, 0.1128 s/token                 
First token throughput: 0.7995 tokens/sec, 1.2508 s/token                 
 Next token throughput: 9.3420 tokens/sec, 0.1070 s/token                     

Bandwidth achieved: 142.43 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, in a world not so different from our own.
In a city bustling with life, where dreams and possibilities were as abundant as the concrete and steel of its towering skyscrapers, there lived a young woman named Lena.

Lena was a brilliant inventor, with a mind that sparkled like the stars in a midnight sky. She spent most of her days lost in the world of machines and gears, fueled by a passion that burned brighter than any fire.

Her latest creation, a machine that could convert sunlight into a limitless source of clean energy, was her magnum opus. It stood tall and proud in her small, cluttered workshop, its metal casing gleaming with promise.

With a sense of pride and accomplishment, Lena stood before her machine, her heart pounding in her chest. This was it, the moment of truth. With one final check, she would be ready to unveil her invention to the world.

But little did she know, in the shadows of her workshop, a sinister
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 2: 20.0297 sec total                 
Time to first token: 0.0846 sec with parallel prefill.                

      Total throughput: 9.9852 tokens/sec, 0.1001 s/token                 
First token throughput: 11.8250 tokens/sec, 0.0846 s/token                 
 Next token throughput: 9.9774 tokens/sec, 0.1002 s/token                     

Bandwidth achieved: 160.37 GB/s

========================================

Once upon a time, I had a brilliant idea, a project that I thought would change the world. I was going to create a company that made pillows with built-in, state-of-the-art, temperature regulation systems. The pillows would keep you cool in the summer and warm in the winter. The selling point was that you would no longer have to worry about adjusting the thermostat in your home, and the trees would be happy because we would be using a lot of eco-friendly materials in our products. I sounded like a genius trying to get funding from investors. I did my research, I put together a business plan, and I even designed a prototype. I was ready to pitch my idea to anyone who would listen.
Here's the thing: I had no idea how to make a pillow, or even what materials would be required to make it work. I was an expert on marketing, but I had no expertise in textiles, thermodynamics or materials science. I didn't know that the materials I would need were not
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 3: 19.9280 sec total                 
Time to first token: 0.0851 sec with parallel prefill.                

      Total throughput: 10.0361 tokens/sec, 0.0996 s/token                 
First token throughput: 11.7567 tokens/sec, 0.0851 s/token                 
 Next token throughput: 10.0288 tokens/sec, 0.0997 s/token                     

Bandwidth achieved: 161.19 GB/s

========================================


      Average tokens/sec (total): 9.63                 
Average tokens/sec (first token): 8.13                 
Average tokens/sec (next tokens): 9.78 
                
Memory used: 22.40 GB
