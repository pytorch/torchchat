
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cuda"}}' --prompt "Once upon a time," --max-new-tokens 200 --num-samples 3
PyTorch version 2.6.0.dev20241002+cu121 available.
lm_eval is not installed, GPTQ may not be usable
Using device=cuda NVIDIA PG509-210
Loading model...
Time to load model: 5.33 seconds
Quantizing the model with: {'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cuda'}}
Time to quantize model: 0.01 seconds
-----------------------------------------------------------
Once upon a time, in a far-off land, there was a beautiful and peaceful kingdom. The kingdom was known for its lush green forests, sparkling rivers, and rolling hills. The kingdom was home to many animals, including rabbits, deer, and birds. The kingdom was ruled by a wise and just king, who loved his people and his animals dearly. The king was known for his fairness and compassion, and his people lived happily and in harmony with the natural world.
One day, a great and terrible dragon appeared in the kingdom. The dragon was fierce and powerful, and it breathed fire and destruction wherever it went. The people of the kingdom were terrified, and they begged their king to do something to stop the dragon.
The king, being a wise and just ruler, called upon the wisest men and women in the kingdom to come and advise him on how to deal with the dragon. The advisors came from all walks of life, including farmers, teachers, and healers. They all brought their knowledge and
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 1: 23.2359 sec total                 
Time to first token: 1.3874 sec with parallel prefill.                

      Total throughput: 8.6074 tokens/sec, 0.1162 s/token                 
First token throughput: 0.7208 tokens/sec, 1.3874 s/token                 
 Next token throughput: 9.1082 tokens/sec, 0.1098 s/token                     

Bandwidth achieved: 138.24 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, over 800 years ago in Silla Kingdom, a young prince named Uisang was born. Uisang grew up in a world of great turmoil and violence where the three kingdoms of Korea were constantly at war with each other. Despite this, Uisang's parents were great lovers of Buddhism and they instilled in him a deep love and respect for the teachings of the Buddha.
As Uisang grew up, he became increasingly disillusioned with the violence and brutality of the world around him, and began to seek answers in the teachings of the Buddha. He spent many years studying the scriptures and practicing the meditation techniques of Buddhism, and eventually became a great master of the teachings.
One day, Uisang was ordained as a monk in the Hwangnang Temple in Seorabol, and began to share his wisdom with others. He taught that the ultimate nature of reality is empty and non-dual, and that all phenomena arise from the mind. He taught that the root
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 2: 21.1877 sec total                 
Time to first token: 0.0899 sec with parallel prefill.                

      Total throughput: 9.4394 tokens/sec, 0.1059 s/token                 
First token throughput: 11.1210 tokens/sec, 0.0899 s/token                 
 Next token throughput: 9.4323 tokens/sec, 0.1060 s/token                     

Bandwidth achieved: 151.60 GB/s

========================================

Once upon a time, there was a world where technology reigned supreme. Cities were built with gleaming skyscrapers that touched the clouds, and the streets hummed with the gentle purr of flying cars. Humans lived in harmony with artificial intelligence, their lives made easier by the endless stream of helpful robots and cyborgs. But in this world of wonder and convenience, there lived a young soul, Jack. Jack was a dreamer, a romantic who longed for the simplicity of the past, for the warmth of a fire on a cold winter’s night, for the feel of the wind in his hair as he rode a horse across open plains. He longed for the world before the technology took over, before the hum of machines replaced the songs of birds.
One day, Jack stumbled upon a strange and mysterious artifact hidden deep within the city’s ancient streets. It was an old, leather-bound book, adorned with strange symbols and markings that seemed to shimmer in the dim light. The book was said
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 199 tokens                 
Time for inference 3: 20.9979 sec total                 
Time to first token: 0.0918 sec with parallel prefill.                

      Total throughput: 9.5248 tokens/sec, 0.1050 s/token                 
First token throughput: 10.8895 tokens/sec, 0.0918 s/token                 
 Next token throughput: 9.5188 tokens/sec, 0.1051 s/token                     

Bandwidth achieved: 152.97 GB/s

========================================


      Average tokens/sec (total): 9.19                 
Average tokens/sec (first token): 7.58                 
Average tokens/sec (next tokens): 9.35 
                
Memory used: 16.68 GB
