
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
OMP_NUM_THREADS=16 numactl --cpunodebind=0 --membind=0 python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
PyTorch version 2.6.0.dev20241002+cu121 available.
lm_eval is not installed, GPTQ may not be usable
Using device=cpu Intel(R) Xeon(R) Platinum 8339HC CPU @ 1.80GHz
Loading model...
Time to load model: 0.12 seconds
Quantizing the model with: {'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 0.01 seconds
-----------------------------------------------------------
Once upon a time, in the bustling city of London, there was a small, quaint shop tucked away in a quiet alley. The sign above the door read "Curios and Wonders," and the shop itself was a treasure trove of strange and fascinating items.
The shop was owned by a kindly old man named Mr. Jenkins, who had a passion for collecting the unusual and the unknown. Over the years, he had amassed a vast collection of artifacts and curiosities from all corners of the globe.
One day, a young woman named Emily wandered into Curios and Wonders, searching for a rare and exotic spice to use in a recipe she was experimenting with. As she browsed the shelves, her eyes landed on a peculiar-looking vase with a strange symbol etched onto its side.
"Ah, that's a lovely piece," said Mr. Jenkins, noticing Emily's interest. "It's a rare ceramic from ancient China, said to have been created by a secret society of artisans. The symbol on the side is a representation of their mystical language."
Emily was intrigued. "A mystical language, you say? What does it mean?"
Mr. Jenkins smiled. "Well, that's the beauty of it. No one knows for sure. Some say it holds the secrets of
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 121.6180 sec total                 
Time to first token: 0.6484 sec with parallel prefill.                

      Total throughput: 2.1050 tokens/sec, 0.4751 s/token                 
First token throughput: 1.5423 tokens/sec, 0.6484 s/token                 
 Next token throughput: 2.1080 tokens/sec, 0.4744 s/token                     

Bandwidth achieved: 33.81 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, in a small village nestled in the rolling hills of Provence, there was a tiny bakery called Le Petit Pain. It was a cozy, rustic bakery that had been in the family for generations, run by the same family of skilled bakers who had inherited the recipe books and techniques from their ancestors.
The villagers adored Le Petit Pain, not only for its heavenly pastries and breads but also for its charming atmosphere. The bakery was a place where everyone knew each other, where the bakers would often give away treats to the children and the elderly, and where the family would invite the villagers to join in on special occasions.

In a small corner of the bakery, there was a special display case filled with the finest pastries, all made by the family's young apprentice, Sophie. Sophie was a talented baker who had grown up watching her parents and grandparents work in the bakery. She had a passion for creating new recipes and experimenting with different flavors and ingredients.

One day, Sophie decided to enter Le Petit Pain into a prestigious baking competition in the nearby town of Avignon. The competition was held annually, and the winner would receive a year's supply of the finest flours, a golden trophy, and the title of "Best Baker in the Region."

Sophie
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 121.9192 sec total                 
Time to first token: 0.3606 sec with parallel prefill.                

      Total throughput: 2.0998 tokens/sec, 0.4762 s/token                 
First token throughput: 2.7734 tokens/sec, 0.3606 s/token                 
 Next token throughput: 2.0978 tokens/sec, 0.4767 s/token                     

Bandwidth achieved: 33.72 GB/s

========================================

Once upon a time, in a far-off land, there was a magical kingdom ruled by a wise and just king. The king was known far and wide for his kindness, generosity, and love for all living things. He ruled with a fair hand, making sure that all his subjects were happy and content.
One day, a poor and starving traveler stumbled upon the kingdom. The traveler was a young man named Tim, who had been wandering the desert for many days with nothing but his wits and a small sack of provisions. As he entered the kingdom, he was struck by its beauty and the warmth of its people.
The king, seeing the young traveler, welcomed him with open arms and invited him to stay in the kingdom for as long as he needed. Tim was overjoyed and gratefully accepted the king's offer.
As Tim settled into his new home, he was amazed by the kingdom's wonders. The king's court was filled with wise advisors, skilled craftsmen, and talented artists. The kingdom was a place of learning, where people from all over the world came to study, innovate, and share their knowledge.
The king, noticing Tim's interest and curiosity, approached him and said, "My young friend, I sense that you are a seeker of knowledge and wisdom.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 127.0859 sec total                 
Time to first token: 0.4297 sec with parallel prefill.                

      Total throughput: 2.0144 tokens/sec, 0.4964 s/token                 
First token throughput: 2.3274 tokens/sec, 0.4297 s/token                 
 Next token throughput: 2.0133 tokens/sec, 0.4967 s/token                     

Bandwidth achieved: 32.35 GB/s

========================================


      Average tokens/sec (total): 2.07                 
Average tokens/sec (first token): 2.21                 
Average tokens/sec (next tokens): 2.07 
                
Memory used: 0.00 GB
