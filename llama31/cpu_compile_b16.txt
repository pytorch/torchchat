
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
Using device=cpu Intel(R) Xeon(R) Platinum 8339HC CPU @ 1.80GHz
Loading model...
Time to load model: 0.11 seconds
Quantizing the model with: {'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 0.01 seconds
-----------------------------------------------------------
Once upon a time, there was a small town nestled in the heart of a beautiful valley. The town was called Willowdale, and it was famous for its stunning natural surroundings, charming architecture, and friendly residents.
One day, a group of travelers stumbled upon Willowdale while on a journey to explore the surrounding countryside. As they entered the town, they were greeted by the warm smiles of the locals, who welcomed them with open arms.
The travelers were amazed by the town's picturesque atmosphere, with its cobblestone streets, quaint shops, and vibrant marketplaces. They spent their days exploring the town, marveling at its beauty, and enjoying the hospitality of the residents.
However, as the days passed, the travelers began to notice something strange. Despite the town's idyllic appearance, they sensed that something was amiss. The residents seemed to be living in a state of suspended animation, as if they were stuck in a perpetual state of sleep.
The travelers soon discovered that the town was under a mysterious spell, cast by a powerful sorcerer who had been living in the town for centuries. The sorcerer, known as the Wizard of Willowdale, had been using his magic to keep the town frozen in time, preventing it from changing or progressing in any way.
The travelers,2024-10-31:19:29:33,879 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 621.9802 sec total                 
Time to first token: 5.8463 sec with parallel prefill.                

      Total throughput: 0.4116 tokens/sec, 2.4296 s/token                 
First token throughput: 0.1710 tokens/sec, 5.8463 s/token                 
 Next token throughput: 0.4139 tokens/sec, 2.4162 s/token                     
2024-10-31:19:29:33,879 INFO     [generate.py:1173] 
Bandwidth achieved: 6.61 GB/s
2024-10-31:19:29:33,879 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches, JIT compilation. ***
just-in-time compilation time (incl run time): 6.2e+02 seconds

========================================

Once upon a time, there was a beautiful garden filled with vibrant flowers, towering trees, and sparkling fountains. The garden was a place of serenity and peace, where one could escape the stresses of everyday life and connect with nature's wonders.
One day, a wise and kind gardener, Emma, tended to the garden with love and care. She spent her days pruning the flowers, watering the plants, and whispering words of encouragement to the trees. As she worked, she noticed that the garden seemed to be responding to her presence. The flowers bloomed more vibrantly, the trees grew stronger, and the fountains sang with a sweet, melodic voice.
But Emma was not content to simply tend to the garden. She wanted to share its beauty with others, and so she created a place where people could come to rest, reflect, and rejuvenate. She built a winding path that led visitors through the garden, past hidden clearings and secret waterfalls. She placed benches and gazebos where people could sit and take in the beauty of their surroundings.
As the garden flourished under Emma's care, it became a beloved destination for people from all over the community. They would come to stroll through the garden, sit on a bench, and breathe in the sweet sc2024-10-31:19:37:53,479 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 499.5994 sec total                 
Time to first token: 4.2353 sec with parallel prefill.                

      Total throughput: 0.5124 tokens/sec, 1.9516 s/token                 
First token throughput: 0.2361 tokens/sec, 4.2353 s/token                 
 Next token throughput: 0.5148 tokens/sec, 1.9426 s/token                     
2024-10-31:19:37:53,479 INFO     [generate.py:1173] 
Bandwidth achieved: 8.23 GB/s

========================================

Once upon a time, in a small village nestled in the rolling hills of Provence, there lived a young and ambitious baker named Sophie. Sophie had grown up in the village surrounded by the rich aromas of freshly baked bread and the warmth of the sun-baked earth. She had always been fascinated by the art of baking and had spent countless hours in her father's bakery, learning the secrets of traditional Provençal bread-making.
As she grew older, Sophie's passion for baking only deepened, and she began to experiment with new recipes and techniques. She would often sneak into the bakery late at night, when her father was asleep, and try out new creations. Her experiments were always a hit with the villagers, who would eagerly await her latest innovations.

One day, Sophie had an idea that would change the course of her life forever. She had been experimenting with a new type of bread that combined the traditional Provençal ingredients of olive oil, herbs, and spices with a hint of sweetness from local honey. The result was a bread that was unlike anything she had ever tasted before - it was crispy on the outside, soft and fluffy on the inside, and infused with the subtle flavors of the Mediterranean.

Sophie was ecstatic about her creation and knew she had to share it2024-10-31:19:46:51,771 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 538.2913 sec total                 
Time to first token: 2.4467 sec with parallel prefill.                

      Total throughput: 0.4756 tokens/sec, 2.1027 s/token                 
First token throughput: 0.4087 tokens/sec, 2.4467 s/token                 
 Next token throughput: 0.4759 tokens/sec, 2.1014 s/token                     
2024-10-31:19:46:51,771 INFO     [generate.py:1173] 
Bandwidth achieved: 7.64 GB/s

========================================


      Average tokens/sec (total): 0.47                 
Average tokens/sec (first token): 0.27                 
Average tokens/sec (next tokens): 0.47 
                
Memory used: 0.00 GB
