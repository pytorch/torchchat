
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
Using device=cpu Intel(R) Xeon(R) Platinum 8339HC CPU @ 1.80GHz
Loading model...
Time to load model: 0.11 seconds
Quantizing the model with: {'linear:int8': {'groupsize': 0}, 'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 42.09 seconds
-----------------------------------------------------------
Once upon a time, in a time long past, there was a great king who ruled over a vast and prosperous kingdom. The king was just and fair, loved by his people, but as time went on he grew increasingly paranoid and tyrannical. He became convinced that a group of nobles, led by his own brother, were plotting against him.
The king ordered his brother to be brought before him, and when he arrived, he demanded to know the truth about the supposed plotting. The brother, who was innocent, denied any wrongdoing, but the king would not believe him. In a fit of rage, the king ordered his brother to be thrown into a deep, dark dungeon, where he would be held captive until he confessed his treason.
But as the days turned into weeks, the king's anger only grew. He became convinced that his brother was hiding a great secret, and that he was in league with the devil himself. He ordered his guards to bring the brother before him daily, and to subject him to all manner of torture and interrogation.
The brother, however, remained steadfast in his innocence, refusing to confess to crimes he had not committed. He was a just and honorable man, and he would not betray his own conscience or compromise his values, no matter the cost.
2024-10-31:12:37:07,096 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 445.6991 sec total                 
Time to first token: 2.4685 sec with parallel prefill.                

      Total throughput: 0.5744 tokens/sec, 1.7410 s/token                 
First token throughput: 0.4051 tokens/sec, 2.4685 s/token                 
 Next token throughput: 0.5753 tokens/sec, 1.7382 s/token                     
2024-10-31:12:37:07,097 INFO     [generate.py:1173] 
Bandwidth achieved: 4.92 GB/s
2024-10-31:12:37:07,097 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches, JIT compilation. ***
just-in-time compilation time (incl run time): 4.5e+02 seconds

========================================

Once upon a time, in a magical kingdom, there lived a young girl named Lily. Lily was a curious and adventurous soul, with a heart full of wonder and a mind full of questions. One day, while wandering through the kingdom's market, Lily stumbled upon a small, mysterious shop tucked away between a bakery and a blacksmith. The sign above the door read "Curios and Wonders," and the windows were filled with a dazzling array of strange and exotic items.
Lily's curiosity was piqued, and she pushed open the door to venture inside. The shop was dimly lit, and the air was thick with the scent of old books and dust. The proprietor, an elderly man with spectacles perched on the end of his nose, looked up from behind the counter and greeted Lily with a warm smile.
"Welcome, young one, to Curios and Wonders," he said, his voice dripping with enchantment. "I am Mr. Jenkins, the proprietor and guardian of this humble shop. What brings you to my humble abode today?"
Lily's eyes widened as she scanned the shelves, taking in the array of peculiar items on display. There were ancient artifacts, curious trinkets, and mysterious devices that seemed to defy explanation. She spotted a2024-10-31:12:42:53,535 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 346.4377 sec total                 
Time to first token: 4.6187 sec with parallel prefill.                

      Total throughput: 0.7389 tokens/sec, 1.3533 s/token                 
First token throughput: 0.2165 tokens/sec, 4.6187 s/token                 
 Next token throughput: 0.7460 tokens/sec, 1.3405 s/token                     
2024-10-31:12:42:53,535 INFO     [generate.py:1173] 
Bandwidth achieved: 6.32 GB/s

========================================

Once upon a time, there was a street food festival in a bustling city. Among the numerous stalls selling various foods, one particular stall caught the attention of a young food blogger named Sarah. The stall was called “Tandoori Twist” and was run by an elderly Indian chef named Ramesh. Sarah had never tried Indian street food before, and Ramesh’s stall was the first one that made her curious.
As soon as Sarah approached the stall, Ramesh greeted her with a warm smile and a twinkle in his eye. He introduced himself and asked her about her preferences, trying to understand what type of Indian cuisine she might enjoy. Sarah was taken aback by Ramesh’s genuine interest in her taste buds and his eagerness to share his passion with her.
Ramesh recommended his specialty dish, a Tandoori Chicken Tikka wrap, which he assured her would be unlike anything she had ever tasted before. Sarah was hesitant at first, but her curiosity got the better of her, and she decided to give it a try.
As she waited for her food, Sarah noticed the aroma of spices and herbs filling the air, and the sound of sizzling vegetables and meat on the grill. She couldn’t help but feel a sense of excitement and anticipation.
When2024-10-31:12:47:23,337 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 269.8015 sec total                 
Time to first token: 2.8776 sec with parallel prefill.                

      Total throughput: 0.9488 tokens/sec, 1.0539 s/token                 
First token throughput: 0.3475 tokens/sec, 2.8776 s/token                 
 Next token throughput: 0.9553 tokens/sec, 1.0468 s/token                     
2024-10-31:12:47:23,337 INFO     [generate.py:1173] 
Bandwidth achieved: 8.12 GB/s

========================================


      Average tokens/sec (total): 0.75                 
Average tokens/sec (first token): 0.32                 
Average tokens/sec (next tokens): 0.76 
                
Memory used: 0.00 GB
