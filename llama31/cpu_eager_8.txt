
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
Using device=cpu Intel(R) Xeon(R) Platinum 8339HC CPU @ 1.80GHz
Loading model...
Time to load model: 0.11 seconds
Quantizing the model with: {'linear:int8': {'groupsize': 0}, 'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 45.08 seconds
-----------------------------------------------------------
Once upon a time, in a far-off land, there was a beautiful princess named Sophia. She was known throughout the kingdom for her kindness, intelligence, and beauty. One day, a wicked sorcerer named Malakai cast a spell on Sophia, turning her into a beautiful butterfly.
The sorcerer's spell was so powerful that Sophia was forced to live in the forest, flitting from flower to flower in search of nectar to drink. Despite the magic that had been cast upon her, Sophia remained kind and wise, using her intelligence to outsmart the other creatures in the forest and avoid danger.
One day, a brave knight named Edward came to the forest seeking adventure. He had heard stories of the beautiful princess who lived among the trees, and he was determined to find her. As he rode his horse through the forest, he saw Sophia flitting from flower to flower, her beautiful wings shimmering in the sunlight.
Edward was taken aback by Sophia's transformation, but he was drawn to her kind and gentle nature. He dismounted his horse and approached Sophia, speaking softly to her as he tried to communicate with the butterfly.
Sophia, sensing the knight's good intentions, began to communicate with him through a series of subtle movements and actions. She showed him the beauty of2024-10-31:18:38:16,057 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 466.8859 sec total                 
Time to first token: 2.2178 sec with parallel prefill.                

      Total throughput: 0.5483 tokens/sec, 1.8238 s/token                 
First token throughput: 0.4509 tokens/sec, 2.2178 s/token                 
 Next token throughput: 0.5488 tokens/sec, 1.8222 s/token                     
2024-10-31:18:38:16,058 INFO     [generate.py:1173] 
Bandwidth achieved: 4.69 GB/s
2024-10-31:18:38:16,058 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, in a small village nestled in the rolling hills of a far-off land, there lived a young girl named Sophia. Sophia was a curious and adventurous soul, with a heart full of wonder and a mind full of questions. She loved to explore the world around her, learning about the creatures that lived in the village and the plants that grew in the nearby woods.
One day, while wandering through the woods, Sophia stumbled upon a hidden glade. In the center of the glade stood an enormous tree, its trunk as wide as a house and its branches reaching up towards the sky like giant arms. The tree seemed to be... watching her. Sophia felt a shiver run down her spine as she approached the tree, but she was not afraid. She felt drawn to it, as if it held some secret that she needed to uncover.
As she reached out to touch the trunk, a low, rumbling voice spoke to her. "Welcome, Sophia," it said. "I have been waiting for you."
Sophia's eyes widened in surprise, but she stood her ground. "Who are you?" she asked, her voice barely above a whisper.
"I am the guardian of this forest," the tree replied. "And you, Sophia, are a seeker of truth2024-10-31:18:47:14,555 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 538.4976 sec total                 
Time to first token: 1.4638 sec with parallel prefill.                

      Total throughput: 0.4754 tokens/sec, 2.1035 s/token                 
First token throughput: 0.6832 tokens/sec, 1.4638 s/token                 
 Next token throughput: 0.4748 tokens/sec, 2.1060 s/token                     
2024-10-31:18:47:14,556 INFO     [generate.py:1173] 
Bandwidth achieved: 4.07 GB/s

========================================

Once upon a time, there was a small village nestled in the rolling hills of a lush countryside. The villagers were known for their love of sweets, and their village was famous for its exquisite pastries, cakes, and chocolates.
One day, a young apprentice named Leo found himself lost in the village's bustling market square. The hustle and bustle of the crowd overwhelmed him, and he became disoriented. He stumbled upon a quaint little bakery, with a sign that read "Madame LaRue's Sweet Delights."
Leo pushed open the door and stepped inside. The aroma of freshly baked bread and sweet baked goods wafted through the air, enticing him to enter. Madame LaRue, the proprietor, looked up from her work and greeted him warmly.
"Welcome, young one," she said with a smile. "What brings you to my humble bakery today?"
Leo explained how he had gotten lost in the market square, and Madame LaRue offered him a warm smile. "You're in luck," she said. "Today is a special day. I'm preparing for the village's annual Sweet Festival, and I could use an extra pair of hands."
Leo's eyes widened with excitement as Madame LaRue showed him the intricate preparations she was making for the festival.2024-10-31:18:56:07,562 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 533.0060 sec total                 
Time to first token: 0.4244 sec with parallel prefill.                

      Total throughput: 0.4803 tokens/sec, 2.0821 s/token                 
First token throughput: 2.3565 tokens/sec, 0.4244 s/token                 
 Next token throughput: 0.4788 tokens/sec, 2.0886 s/token                     
2024-10-31:18:56:07,562 INFO     [generate.py:1173] 
Bandwidth achieved: 4.11 GB/s

========================================


      Average tokens/sec (total): 0.50                 
Average tokens/sec (first token): 1.16                 
Average tokens/sec (next tokens): 0.50 
                
Memory used: 0.00 GB
